<ion-header [translucent]="true" class="ion-no-border">
  <ion-toolbar color="primary">
    <ion-title>Paramètres</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true" color="light">
  
  <ion-header collapse="condense">
    <ion-toolbar color="light">
      <ion-title size="large">Paramètres</ion-title>
    </ion-toolbar>
  </ion-header>

  <div class="settings-container">
    
    <!-- Premium Card -->
    <div class="premium-section">
      <div class="premium-card" [class.active]="isPremium" (click)="buyPremium()">
        <div class="card-content">
          <div class="icon-circle">
            <ion-icon name="diamond-outline"></ion-icon>
          </div>
          <div class="text-content">
            <h3 *ngIf="!isPremium">Passer Premium</h3>
            <h3 *ngIf="isPremium">Premium Activé</h3>
            <p *ngIf="!isPremium">Supprimer les pubs & Export données</p>
            <p *ngIf="isPremium">Merci pour votre soutien !</p>
          </div>
          <div class="action-arrow" *ngIf="!isPremium">
            <ion-icon name="chevron-forward"></ion-icon>
          </div>
          <div class="check-mark" *ngIf="isPremium">
            <ion-icon name="checkmark-circle"></ion-icon>
          </div>
        </div>
      </div>
    </div>

    <!-- General Settings -->
    <ion-list [inset]="true">
      <ion-item button id="open-language-modal">
        <div class="icon-slot" slot="start" style="background: #e3f2fd; color: #1565c0;">
          <ion-icon name="globe-outline"></ion-icon>
        </div>
        <ion-label>Langue</ion-label>
        <ion-note slot="end">{{ getLanguageName(selectedLanguage) }}</ion-note>
        <ion-icon name="chevron-forward" slot="end" color="medium" style="font-size: 0.9rem;"></ion-icon>
      </ion-item>

      <ion-item>
        <div class="icon-slot" slot="start" style="background: #f3e5f5; color: #7b1fa2;">
          <ion-icon name="moon-outline"></ion-icon>
        </div>
        <ion-label>Mode Sombre</ion-label>
        <ion-toggle [(ngModel)]="darkMode" slot="end"></ion-toggle>
      </ion-item>
    </ion-list>

    <!-- Data Settings -->
    <ion-list [inset]="true">
      <ion-item button (click)="exportData()">
        <div class="icon-slot" slot="start" style="background: #e8f5e9; color: #2e7d32;">
          <ion-icon name="cloud-download-outline"></ion-icon>
        </div>
        <ion-label>Exporter les données</ion-label>
        <ion-icon slot="end" name="lock-closed-outline" color="medium" *ngIf="!isPremium"></ion-icon>
      </ion-item>

      <ion-item button (click)="clearHistory()">
        <div class="icon-slot" slot="start" style="background: #ffebee; color: #c62828;">
          <ion-icon name="trash-outline"></ion-icon>
        </div>
        <ion-label color="danger">Vider l'historique</ion-label>
      </ion-item>
    </ion-list>

    <!-- About Settings -->
    <ion-list [inset]="true">
      <ion-item button id="open-privacy-modal">
        <div class="icon-slot" slot="start" style="background: #e0f2f1; color: #00695c;">
          <ion-icon name="shield-checkmark-outline"></ion-icon>
        </div>
        <ion-label>Politique de Confidentialité</ion-label>
        <ion-icon name="chevron-forward" slot="end" color="medium" style="font-size: 0.9rem;"></ion-icon>
      </ion-item>

      <ion-item>
        <div class="icon-slot" slot="start" style="background: #eceff1; color: #455a64;">
          <ion-icon name="information-circle-outline"></ion-icon>
        </div>
        <ion-label>Version</ion-label>
        <ion-note slot="end">1.0.0</ion-note>
      </ion-item>
    </ion-list>

  </div>

  <!-- Language Modal -->
  <ion-modal trigger="open-language-modal" [initialBreakpoint]="0.75" [breakpoints]="[0, 0.5, 0.75, 1]">
    <ng-template>
      <ion-header>
        <ion-toolbar>
          <ion-title>Choisir la langue</ion-title>
          <ion-buttons slot="end">
            <ion-button (click)="closeModal()">Fermer</ion-button>
          </ion-buttons>
        </ion-toolbar>
      </ion-header>
      <ion-content>
        <ion-list [inset]="true">
          <ion-item button *ngFor="let lang of languages" (click)="selectLanguage(lang.code)" [detail]="false">
            <ion-label>{{ lang.name }}</ion-label>
            <ion-icon name="checkmark-circle" color="primary" slot="end" *ngIf="selectedLanguage === lang.code"></ion-icon>
          </ion-item>
        </ion-list>
      </ion-content>
    </ng-template>
  </ion-modal>

  <!-- Privacy Policy Modal -->
  <ion-modal trigger="open-privacy-modal">
    <ng-template>
      <ion-header>
        <ion-toolbar>
          <ion-buttons slot="start">
            <ion-button (click)="closeModal()">Fermer</ion-button>
          </ion-buttons>
          <ion-title>Confidentialité</ion-title>
        </ion-toolbar>
      </ion-header>
      <ion-content class="ion-padding">
        <div class="privacy-content">
          <h1>Politique de Confidentialité</h1>
          
          <div class="policy-section">
            <div class="section-icon">
              <ion-icon name="images-outline"></ion-icon>
            </div>
            <h3>Collecte des Images</h3>
            <p>
              Les photos que vous prenez pour générer des mesures sont traitées de manière sécurisée.
              En utilisant cette fonctionnalité, vous acceptez que ces images puissent être utilisées de manière 
              <strong>anonyme</strong> pour entraîner et améliorer nos modèles d'intelligence artificielle.
            </p>
          </div>

          <div class="policy-section">
             <div class="section-icon">
              <ion-icon name="lock-closed-outline"></ion-icon>
            </div>
            <h3>Données Personnelles</h3>
            <p>
              Vos informations personnelles telles que votre nom, votre numéro de téléphone et l'historique précis 
              de vos mesures sont stockées <strong>localement sur votre appareil</strong>.
              Nous ne vendons ni ne partageons ces données personnelles avec des tiers.
            </p>
          </div>

          <ion-button expand="block" (click)="closeModal()" class="ion-margin-top">J'ai compris</ion-button>
        </div>
      </ion-content>
    </ng-template>
  </ion-modal>

</ion-content>
